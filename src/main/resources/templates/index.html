<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>Homepagina</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --aquafin-blauw: #0077c8;
            --aquafin-blauw-donker: #005fa3;
        }
        body {
            background-color: #f8f9fa;
            color: #333;
        }
        h1, h2 {
            color: var(--aquafin-blauw);
            font-weight: 700;
        }
        .product-card {
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
            text-align: center;
        }
        .product-card img {
            max-height: 150px;
            object-fit: contain;
            margin-bottom: 1rem;
        }
        .product-card input[type="number"] {
            max-width: 80px;
            margin: auto;
        }
    </style>
</head>
<body>

<!-- Voeg de navigatiebalk toe via het fragment -->
<div th:replace="fragments/navbar :: navbar"></div>

<div class="container mt-4">
    <h1>Welkom op de Homepagina!</h1>

    <div class="row align-items-center mt-5 mb-3">
        <div class="col-md-6">
            <h2>Populaire producten</h2>
        </div>
        <div class="col-md-6 text-end">
            <form class="d-flex" role="search" id="searchForm">
                <input class="form-control me-2" type="search" id="searchInput" placeholder="Zoek product..." aria-label="Zoeken">
                <button class="btn btn-outline-primary" type="submit"><i class="bi bi-search"></i></button>
            </form>
        </div>
    </div>
    <hr>

    <!-- Producten worden hier geladen door JavaScript -->
    <div id="productsContainer" class="row">
        <!-- Dynamisch geladen producten verschijnen hier -->
    </div>
</div>

<script>
    // Functie om producten op te halen via de API en deze weer te geven
    async function fetchProducts(searchTerm = '') {
        try {
            const url = searchTerm ? `/api/products?search=${searchTerm}` : '/api/products'; // Voeg zoekterm toe aan de URL
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            const products = await response.json();

            // Verwijder de bestaande producten (indien aanwezig)
            const productsContainer = document.getElementById('productsContainer');
            productsContainer.innerHTML = '';

            // Voeg de producten toe aan de pagina
            products.forEach(product => {
                const productCard = `
                    <div class="col-md-4">
                        <div class="product-card">
                            <h5>${product.name}</h5>
                            <img src="${product.image || '/path/to/default-image.jpg'}" alt="${product.name}" class="img-fluid">
                            <p>${product.description || 'Geen beschrijving beschikbaar'}</p>
                            <p><strong>In stock:</strong> ${product.stock}</p>
                            <input type="number" class="form-control mb-2" min="1" value="1">
                            <button class="btn btn-primary">Toevoegen</button>
                        </div>
                    </div>
                `;
                productsContainer.innerHTML += productCard;
            });
        } catch (error) {
            console.error('Er is een fout opgetreden bij het ophalen van de producten:', error);
        }
    }

    // Roep de functie aan om de producten te laden zodra de pagina is geladen
    window.onload = () => fetchProducts();

    // Voeg event listener toe aan de zoekbalk
    const searchForm = document.getElementById('searchForm');
    searchForm.addEventListener('submit', (event) => {
        event.preventDefault();  // Voorkom het standaard gedrag van de zoekbalk
        const searchTerm = document.getElementById('searchInput').value;
        fetchProducts(searchTerm);  // Roep de fetchProducts functie aan met de zoekterm
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
